import{a as ge,b as me,c as j}from"./chunk-LLOOYWH5.js";import{A as x,B as W,C as X,D as M,E as P,F as Y,G as Z,L as ee,M as L,N as ne,O as S,P as te,Q as ie,R as de,S as oe,T as re,U as ae,W as se,_ as le,a as G,b as z,c as J,d as y,e as K,f as p,g as O,h as Q,i as b,j as _,k as f,l as r,m,n as A,o as l,p as o,q as d,r as I,s as D,t as c,u as h,v as a,w as N,x as u,y as q,z as w}from"./chunk-QBU5O5I5.js";var C=class i{constructor(e){this.http=e}apiUrl=`${ge.apiUrl}/agendas`;createAgend(e){return this.http.post(this.apiUrl,e)}getAgends(){return this.http.get(this.apiUrl)}getAgendById(e){return this.http.get(`${this.apiUrl}/${e}`)}updateAgend(e,n){return this.http.put(`${this.apiUrl}/${e}`,n)}deleteAgend(e){return this.http.delete(`${this.apiUrl}/${e}`)}getAgendsByPersonaId(e){return this.http.get(`${this.apiUrl}/persona/${e}`)}static \u0275fac=function(n){return new(n||i)(K(Z))};static \u0275prov=J({token:i,factory:i.\u0275fac,providedIn:"root"})};var T=class i{agenda;select=new f;selectAgend(){this.agenda&&this.select.emit(this.agenda)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=p({type:i,selectors:[["app-agends-agend-card"]],inputs:{agenda:"agenda"},outputs:{select:"select"},decls:8,vars:5,consts:[[1,"bg-white","rounded-lg","shadow-md","p-4","m-2","transition-shadow","hover:shadow-lg","cursor-pointer"],[1,"text-lg","font-semibold"]],template:function(n,t){n&1&&(o(0,"div",0)(1,"h2",1),a(2),d(),o(3,"p"),a(4),d(),o(5,"p"),a(6),w(7,"date"),d()()),n&2&&(r(2),N(t.agenda==null?null:t.agenda.nombre),r(2),u("Tipo: ",t.agenda==null?null:t.agenda.tipo_agenda,""),r(2),u("Creado: ",x(7,3,t.agenda==null?null:t.agenda.fecha_creacion),""))},dependencies:[P]})};function he(i,e){if(i&1){let n=D();o(0,"div",1)(1,"h2",2),a(2),d(),o(3,"p",3),a(4),d(),o(5,"p",4),a(6),w(7,"date"),d(),o(8,"p",5),a(9),w(10,"date"),d(),o(11,"div",6)(12,"button",7),a(13," Ver Detalles "),d(),o(14,"button",8),c("click",function(){b(n);let s=h();return _(s.toDeleteAgend())}),a(15," Eliminar "),d(),o(16,"button",9),c("click",function(){b(n);let s=h();return _(s.toEditAgend())}),a(17," Editar "),d()()()}if(i&2){let n=h();r(2),u(" ",n.selectedAgend.nombre," "),r(2),u("Tipo de agenda: ",n.selectedAgend.tipo_agenda,""),r(2),u(" Creado: ",x(7,4,n.selectedAgend.fecha_creacion)," "),r(3),u(" Actualizado: ",x(10,6,n.selectedAgend.fecha_modificacion)," ")}}var k=class i{constructor(e,n,t){this.dialog=e;this.router=n;this.sharedService=t}selectedAgend;deleteAgend=new f;editAgend=new f;toDeleteAgend(){if(!this.selectedAgend){console.error("No hay agenda seleccionada para eliminar");return}this.dialog.open(me).afterClosed().subscribe(n=>{n?this.deleteAgend.emit(this.selectedAgend):console.log("No se elimin\xF3 ninguna agenda")})}toEditAgend(){if(!this.selectedAgend){console.error("No hay agenda seleccionada para editar");return}this.editAgend.emit(this.selectedAgend)}static \u0275fac=function(n){return new(n||i)(m(le),m(ee),m(j))};static \u0275cmp=p({type:i,selectors:[["app-agends-agend-details-card"]],inputs:{selectedAgend:"selectedAgend"},outputs:{deleteAgend:"deleteAgend",editAgend:"editAgend"},decls:1,vars:1,consts:[["class","bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",4,"ngIf"],[1,"bg-white","rounded-lg","shadow-md","p-6","hover:shadow-lg","transition-shadow"],[1,"text-lg","font-semibold","text-gray-800","mb-2"],[1,"text-gray-600"],[1,"text-gray-400","text-xs","mt-2"],[1,"text-gray-400","text-xs"],[1,"flex","m-2"],[1,"bg-blue-500","text-white","p-2","rounded","m-0.5","w-1/2","hover:bg-blue-600","transition"],[1,"bg-red-400","text-white","p-2","rounded","m-0.5","w-1/4","hover:bg-red-600","transition",3,"click"],[1,"bg-green-600","text-white","p-2","rounded","m-0.5","w-1/4","hover:bg-green-700","transition",3,"click"]],template:function(n,t){n&1&&A(0,he,18,8,"div",0),n&2&&l("ngIf",t.selectedAgend)},dependencies:[M,P]})};var ce=i=>({"border-red-500":i});function be(i,e){i&1&&(o(0,"div",11),a(1," El nombre de la agenda es obligatorio. "),d())}function _e(i,e){i&1&&(o(0,"div",11),a(1," El tipo de agenda es obligatorio. "),d())}var R=class i{constructor(e,n){this.fb=e;this.agendService=n}toEditAgend;personOwner;agendAdded=new f;editedAgend=new f;agendaForm;titleAgendForm="Agregar agenda";ngOnInit(){this.loadForm()}ngOnChanges(e){e.toEditAgend&&this.loadForm()}loadForm(){this.toEditAgend?(this.titleAgendForm="Editar agenda",this.agendaForm=this.fb.group({nombre:[this.toEditAgend.nombre,S.required],tipo_agenda:[this.toEditAgend.tipo_agenda,S.required]})):this.agendaForm=this.fb.group({nombre:["",S.required],tipo_agenda:["",S.required]})}onSubmit(){if(this.toEditAgend&&this.toEditAgend._id){let e=G({},this.agendaForm.value);this.agendService.updateAgend(this.toEditAgend._id,e).subscribe(()=>{this.agendaForm.reset(),this.titleAgendForm="Agregar agenda",this.editedAgend.emit(!0)})}else if(this.agendaForm.valid&&this.personOwner){let e=z(G({},this.agendaForm.value),{persona_id:this.personOwner._id});this.agendService.createAgend(e).subscribe(n=>{this.agendAdded.emit(n),this.agendaForm.reset()})}}static \u0275fac=function(n){return new(n||i)(m(ae),m(C))};static \u0275cmp=p({type:i,selectors:[["app-agends-agend-form"]],inputs:{toEditAgend:"toEditAgend",personOwner:"personOwner"},outputs:{agendAdded:"agendAdded",editedAgend:"editedAgend"},features:[Q],decls:17,vars:11,consts:[[1,"max-w-lg","mx-auto","mt-8","bg-white","p-6","rounded","m-4"],[1,"text-2xl","font-bold","mb-6","text-center"],[3,"ngSubmit","formGroup"],[1,"mb-4"],["for","nombre",1,"block","text-gray-700"],["id","nombre","type","text","formControlName","nombre",1,"w-full","p-2","border","border-gray-300","rounded",3,"ngClass"],["class","text-red-500",4,"ngIf"],["for","tipo_agenda",1,"block","text-gray-700"],["id","tipo_agenda","type","text","formControlName","tipo_agenda",1,"w-full","p-2","border","border-gray-300","rounded",3,"ngClass"],[1,"flex","justify-center"],["type","submit",1,"bg-blue-500","text-white","p-2","rounded","m-0.5","w-8/12","hover:bg-blue-600","transition",3,"disabled"],[1,"text-red-500"]],template:function(n,t){if(n&1&&(o(0,"div",0)(1,"h2",1),a(2),d(),o(3,"form",2),c("ngSubmit",function(){return t.onSubmit()}),o(4,"div",3)(5,"label",4),a(6,"Nombre de la Agenda"),d(),I(7,"input",5),A(8,be,2,0,"div",6),d(),o(9,"div",3)(10,"label",7),a(11,"Tipo de Agenda"),d(),I(12,"input",8),A(13,_e,2,0,"div",6),d(),o(14,"div",9)(15,"button",10),a(16," Agregar Agenda "),d()()()()),n&2){let s,g,E,F;r(2),N(t.titleAgendForm),r(),l("formGroup",t.agendaForm),r(4),l("ngClass",q(7,ce,((s=t.agendaForm.get("nombre"))==null?null:s.invalid)&&((s=t.agendaForm.get("nombre"))==null?null:s.touched))),r(),l("ngIf",((g=t.agendaForm.get("nombre"))==null?null:g.invalid)&&((g=t.agendaForm.get("nombre"))==null?null:g.touched)),r(4),l("ngClass",q(9,ce,((E=t.agendaForm.get("tipo_agenda"))==null?null:E.invalid)&&((E=t.agendaForm.get("tipo_agenda"))==null?null:E.touched))),r(),l("ngIf",((F=t.agendaForm.get("tipo_agenda"))==null?null:F.invalid)&&((F=t.agendaForm.get("tipo_agenda"))==null?null:F.touched)),r(2),l("disabled",t.agendaForm.invalid)}},dependencies:[W,M,de,ne,te,ie,oe,re]})};function Ie(i,e){if(i&1){let n=D();o(0,"div",7),c("click",function(){let s=b(n).$implicit,g=h();return _(g.selectAgend(s))}),o(1,"app-agends-agend-card",8),c("select",function(s){b(n);let g=h();return _(g.selectAgend(s))}),d()()}if(i&2){let n=e.$implicit;r(),l("agenda",n)}}var $=class i{constructor(e){this.agendService=e}personOwner;agends_list=[];isLoading=!1;errorMessage=null;selectedAgend;toEditAgend;ngOnInit(){this.personOwner&&this.loadAgendas()}loadAgendas(){this.personOwner&&this.personOwner._id&&(this.isLoading=!0,this.agendService.getAgendsByPersonaId(this.personOwner._id).subscribe(e=>{this.agends_list=e,this.isLoading=!1,this.errorMessage=null},e=>{this.isLoading=!1,this.errorMessage="Error al cargar las agendas. Por favor, int\xE9ntelo de nuevo.",console.error("Error al cargar las agendas:",e)}))}onAgendAdded(e){this.agends_list.push(e)}onAgendDeleted(e){e&&e._id?this.agendService.deleteAgend(e._id).subscribe(()=>{this.loadAgendas(),this.selectedAgend=void 0},n=>{console.error(n)}):console.log("Invalid agenda to delete")}onAgendEdited(e){e&&(this.toEditAgend=e)}onAgendEditedSuccess(e){e&&(this.loadAgendas(),this.selectedAgend=void 0,this.toEditAgend=void 0)}selectAgend(e){this.selectedAgend=e}static \u0275fac=function(n){return new(n||i)(m(C))};static \u0275cmp=p({type:i,selectors:[["app-agends-dashboard"]],inputs:{personOwner:"personOwner"},decls:7,vars:4,consts:[[1,"min-h-screen","flex","flex-col","items-center","justify-between","bg-blue-500","p-4"],[1,"flex","mb-8","w-full"],[1,"w-1/2","justify-center"],[3,"deleteAgend","editAgend","selectedAgend"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-3","lg:grid-cols-4","gap-6","mb-8","w-full","max-w-6xl","px-4"],[3,"click",4,"ngFor","ngForOf"],[3,"editedAgend","agendAdded","toEditAgend","personOwner"],[3,"click"],[3,"select","agenda"]],template:function(n,t){n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-agends-agend-details-card",3),c("deleteAgend",function(g){return t.onAgendDeleted(g)})("editAgend",function(g){return t.onAgendEdited(g)}),d()()(),o(4,"div",4),A(5,Ie,2,1,"div",5),d(),o(6,"app-agends-agend-form",6),c("editedAgend",function(g){return t.onAgendEditedSuccess(g)})("agendAdded",function(g){return t.onAgendAdded(g)}),d()()),n&2&&(r(3),l("selectedAgend",t.selectedAgend),r(2),l("ngForOf",t.agends_list),r(),l("toEditAgend",t.toEditAgend)("personOwner",t.personOwner))},dependencies:[X,T,k,R]})};var B=class i{constructor(e){this.sharedService=e}personOwner;ngOnInit(){this.personOwner=this.sharedService.getData()}static \u0275fac=function(n){return new(n||i)(m(j))};static \u0275cmp=p({type:i,selectors:[["app-agends-agends-page"]],decls:4,vars:2,consts:[[1,"min-h-screen","flex","flex-col","items-center","justify-between","bg-blue-500"],[1,"text-4xl","font-bold","mb-8","text-white"],[3,"personOwner"]],template:function(n,t){n&1&&(o(0,"div",0)(1,"h1",1),a(2),d(),I(3,"app-agends-dashboard",2),d()),n&2&&(r(2),u(" Agendas de ",t.personOwner==null?null:t.personOwner.nombrecompleto," "),r(),l("personOwner",t.personOwner))},dependencies:[$]})};var xe=[{path:"",component:B}],U=class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=O({type:i});static \u0275inj=y({imports:[L.forChild(xe),L]})};var ue=class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=O({type:i});static \u0275inj=y({imports:[Y,U,se]})};export{ue as AgendsModuleModule};
